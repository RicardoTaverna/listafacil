import React, { useRef } from 'react';
import './product.css';
import { api } from "../../services/api";
import { Button } from "primereact/button";
import { Divider } from 'primereact/divider';
import { OverlayPanel } from 'primereact/overlaypanel';
const Product = (props) => {

    const op = useRef(null);
    const op2 = useRef(null);
    const listId = props.listId;
    const id = props.id;
    const description = props.description;
    const discount = props.discount;
    const price_table = props.price_table;
    const price = props.price;
    const updated = props.updated;
    const establishment = props.establishment;

    const onAddProduct = async e => {
        let name = description;
        let value = parseFloat(price);
        let stablishment = establishment.nm_emp;
        let productId;
        console.log({ name, value, stablishment })
        try {
            await api.post('/product', { name, value, stablishment }).then((request) => {
                console.log(request)
            })
            
                
        } catch (err) {
            console.log('error', err);
        }

    } 

    return (
        <React.Fragment>

            <OverlayPanel ref={op} showCloseIcon id="overlay_panel" style={{width: '450px'}} className="overlaypanel-demo">
                <p>Estabelecimento: {establishment.nm_emp}</p>
                <p>Endere√ßo: {establishment.nm_logr}, {establishment.nr_logr}</p>
                <p>Bairro: {establishment.bairro}</p>
                <p>Cidade: {establishment.mun}</p>
            </OverlayPanel>

            <OverlayPanel ref={op2} showCloseIcon id="overlay_panel" style={{width: '450px'}} className="overlaypanel-demo">
                <h4>Valores</h4>
                <p>Valor de desconto: {discount}</p>
                <p>Valor de tabela: {price_table}</p>
                <p>Valor final: {price}</p>
            </OverlayPanel>

            <div className="product-card-item">
                <div className="">
                    
                    <h4>{description}</h4>
                    <h3>R${price}</h3>
                    
                    <div className="data-text">
                        <p><i className="pi pi-calendar p-mr-2">
                        </i>{updated}</p>
                    </div>
                    
                </div>
                <Divider></Divider>
                <div className="p-d-flex">
                    <Button className="p-button-outlined p-button-success" icon="pi pi-dollar" label="Valores" onClick={(e) => op2.current.toggle(e)} aria-haspopup aria-controls="overlay_panel"/>
                    <Button className="p-button-outlined p-button-info p-ml-2" icon="pi pi-eye" label="Estabelecimento" onClick={(e) => op.current.toggle(e)} aria-haspopup aria-controls="overlay_panel"/>
                    <Button icon="pi pi-plus" className="p-button-primary p-ml-2" onClick={onAddProduct}/>
                </div>
                <div className="data-text">
                    <p className="p-text-italic">REF: {id}</p>
                </div>
            </div>
        </React.Fragment>
    )
}

export default Product;